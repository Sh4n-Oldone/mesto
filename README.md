# Проект 4: Место

### Обзор

* Ссылка на работу
* Ссылка на макет
* План работы
* Обнаруженные трудности/замечания
* Процесс рефакторинга v.2.0 после первого ревью
* Исправление ошибок и рефакторинг v.3.0
* Исправление ошибок и рефакторинг v.4.0
* Список веток

**GithubPages**

* [Ссылка на работу в GithubPages](https://sh4n-oldone.github.io/mesto/)

**Figma**

* [Ссылка на макет в Figma](https://www.figma.com/file/StZjf8HnoeLdiXS7dYrLAh/JavaScript.-Sprint-4)
* [Дополнения к макету](https://www.figma.com/file/nlYpT4VhFiwimn2YlncrcF/JavaScript.-Sprint-5?node-id=0%3A1)

**План работы**
>v.1.0
- [x] Собрать структуру страницы
- [x] Собрать макет
- [x] Проверить на отсутствие скроллов
- [x] Собрать поп-ап
- [x] Прописать JS для открытия/закрытия popup блока
- [x] Прописать JS для сохранения текста в инпутах
- [x] Свериться с чеклистом
- [x] Сдать на первое ревью
- [x] Исправить вёрстку
- [x] Исправить рекомендации
- [x] Сдать на второе ревью

>v.2.0
- [x] Удалить карточки, заменив их темплейтом
- [x] Подгрузить первые шесть карточек через JS (удалить из html оригинальные)
- [x] Собрать новый поп-ап для формы добавления карточки
- [x] Прописать JS для открытия/закрытия этой формы
- [x] Прописать JS для добавления карточки в начало списка
- [x] Прописать глобальный клик для лайков через метод .target
- [x] Добавить иконку удаления для карточек (внести кнопку в темплейт)
- [x] Прописать JS для удаления карточки
- [x] Создать попап для открытия картинки из карточки в полный размер по клику на ней
- [x] Добавить плавности открытию и закрытию всех попапов [тред в помощь](https://stackoverflow.com/questions/3331353/transitions-on-the-css-display-property)
- [x] Сверить поп-апы с макетом
- [x] Сдать на первое ревью.
- [x] Сдать на второе ревью.
- [x] Исправить рекомендации.

>v.2.1
- [x] Новый подход к импортам стилей.

>v.3.0
- [x] Отдельный файл для кода валидации validate.js
- [x] Валидация формы профиля
  - [x] Оба поля обязательные
  - [x] Имя от 2 до 40 символов
  - [x] О себе от 2 до 200 символов
  - [x] Стандартные браузерные ошибки
  - [x] Кнопка активна только если оба поля прошли валидацию
- [x] Валидация новой карточки
  - [x] Проверка того, что введено в ссылку - URL
  - [x] Название от 1 до 30 символов
  - [x] Нет проверки длины текста ссылки
  - [x] Стандартные браузерные ошибки
  - [x] Кнопка активна только если оба поля прошли валидацию
- [x] Закрытие всех попапов кликом на оверлей
- [x] ЗАкрытие всех попапов кликом на клавишу Esc
- [x] Написать единую функцию enableValidation
- [x] Отправить на первое ревью
- [x] Отправить на второе ревью

>v.4.0

- [x] Создать класс Card, который будет создавать карточку, но не рендерить её
  - [x] Класс принимает данные карточки (имя и ссылку) и темплейт
  - [x] Внутрь перенести все функции, которые работают с элементами карточки - это будут методы
  - [x] Все методы сделать внутренними, а последний - публичным. Он будет возвращать готовую карточку
  - [x] Поменять функции, которые используют эту готовую карточку
  - [x] Вынести класс в отдельный файл Card.js и импортировать в основной файл
- [x] Создать класс FormValidator, который будет проверять валидацию инпутов
  - [x] Класс принимает объект с селекторами и инпут
  - [x] Внутрь перенести все функции по проверке валидации
  - [x] Сделать публичный метод enableValidation, который включает валидацию формы
  - [x] Класс FormValidator использовать для каждой проверяемой формы
  - [x] Вынести класс в отдельный файл FormValidator.js и импортировать в основной файл
- [x] Сделать функцию добавления Listener'а в формы, который добавляет валидацию
- [x] Отправить на первое ревью
- [x] Отправить на второе ревью
- [x] Отправить на третье ревью

**Обнаруженные трудности/замечания и статус решения**

- [x] Неточный макет
- [] Баг в хроме: при загрузке страницы теперь видно, как исчезают подгружающиеся поп-апы. Решено пока не трогать из-за возможных дальнейших проблем в новых заданиях.
- [] При удалении всех карточек, страничка выглядит уныло. Решение: добавить карточку, которая генерируется при проверке массива на нулевую заполненность. Пока не добавлено из-за вероятных дальнейших коллизий с заданиями.
- [x] Можно добавить фишку: при клике на инпуты карточки автоматически удаляется всё, что в ней есть. Нужно будет сделать проверку на Null, чтоб возвращало старое значение, а не добавляло пустую карточку. Upd.: Узнал про placeholder. Сделал просто пустые строки им, а value оставил пустой строкой.
- [x] В каком порядке должны добавляться карточки из массива? Если по нынешним функциям через prepend, то в обратном порялдке, а если пытаться добавить их в прямом порядке, то нужно добавлять условия проверки. Upd.: В обратном ОК.

**Процесс рефакторинга v.2.0 после первого ревью**

- Теперь сначала объявляются переменные, затем создаются функции и после этого добавляются ивенты.
- Функции открытия поп-апов сложены в одну и теперь вызываются по параметру.
- Все let, кроме счётчика, заменены на const.
- Константы в функциях, которые обращаются к дому вынесены наружу.
- Удалены: переменные имён и ссылок массива, функция создания карточек из массива, функция создания новых карточек.
- Добавлены: функция создания карточки из шаблона, функция добавления карточки (вызывающая функцию создания), функция добавления карточек из исходного массива (вызывающая функцию добавления).
- Добавлена отдельная функция, обнуляющая поведение браузера при нажатии на сабмит.

> рекомендации
- Теперь Listener'ы элементов не дублируются.
- Переработка функций лайка, удаления карточки и вызова попапа изображения. Изнутри убран Listener.
- Создана объединяющая слушатели ивентов лайка, удаления карточки и вызова попапа изображения функция - setEventListeners.

**Исправление ошибок и рефакторинг v.3.0**

- В функции imgOpenPopUp дважды искомый элемент вынесен в переменную.
- Удалена функция, вызывающая метод preventDefault. Нужные вызовы используют сам метод.
- При создании карточки функцией createCard теперь добавляется и alt текст картинки.
- addCard переименована в renderCard, для визуального понимания разницы с createCard.
- Функция appendCardList удалена. Исходные карточки теперь создаются из массива прямой командой.
- После добавления новой картчоки инпуты возвращаются к исходному состоянию после добавления слушателю метода reset.
- Теперь попапы слушают клик по оверлею не через всю страницу (page), а по своему непосредственному родителю (page__container).
- Код закрытия попапа по Esc отрефакторен.
- В конце объявления всех функций убран символ ';' в соответствии с концептом чистоты кода.
- Функция submitDisable переименована в toggleButtonState. (Так её задача стала понятнее (?)).
- Функция valueValidation заменена на три самостоятельные функции:
  - checkInputValidity проверяет три вида валидности и возвращает стандартный текст ошибок.
  - showInputError добавляет в переданный ей инпут переданные ей класс инпута и текст ошибки, который записывается в предыдущий DOM-элемент.
  - hideInputError убирает класс, текст ошибки с инпута.
- Функция enableValidation претерпела изменения из-за удаления valueValidation. Передаваемые параметры остались прежними.

**Исправление ошибок и рефакторинг v.4.0**

- В файлах скриптов все двойные кавычки заменены на одиночные.
- Карточки больше не заполняют оставшееся пустым пространство. Теперь только фиксированная ширина и центровка.
- При закрытии попапа создания карточки форма обнуляется.
- Валидация теперь проверяет не всю форму, а каждый инпут отдельно.
- Имя профиля больше не центруется по блока, а остаётся слева.
- Импорты перенесены в начало файлов.
- Функция popUp переименована в togglePopUp для читаемости кода.
- Все поиски по document вынесены в индексе в переменные и импортируются по надобности.
- Массив исходных карточек перенесён в отдельный файл.
- Деструктуризация входящих в класс Card параметров.
- Отменён экспорт в файл с классом Card. Необходимые переменные объявлены прямо в нём.
- Повторяющийся поиск элемента в DOM вынесен в отдельную переменную.
- Удалён отдельный ресет по сабмиту - общая функция ресета формы добавлена в функцию изменений сабмита.

**Ветки и статус**

- master
- DOM/merged
